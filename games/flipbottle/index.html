<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Flip Bottle</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <style>
      html,
      body {
        background: #5e5858;
        padding: 0;
        margin: 0;
        height: 100%;
        overflow: hidden;
      }
    </style>
  </head>

  <body>
    <script>
      window.$T_GAME_VERSION = "1.0.33";
      window.$T_GAME_ARGS = {};
      window.$T__RES__FILE = "resource/default.res.json";
      window.$T__THE__FILE = "resource/default.thm.json";
      window.$T_PROGRESS = 0;
    </script>

    <div
      style="margin: auto; width: 100%; height: 100%"
      class="egret-player"
      data-entry-class="Main"
      data-orientation="auto"
      data-scale-mode="fixedHeight"
      data-frame-rate="60"
      data-content-width="640"
      data-content-height="1136"
    ></div>

    <center>
      <div
        id="btn_play"
        style="
          z-index: 100;
          width: 122px;
          height: 71px;
          position: absolute;
          left: 0;
          right: 0;
          top: 0;
          bottom: 0;
          margin: auto;
          display: none;
        "
      >
        <a
          style="
            padding: 15px 25px;
            background: #4caf50;
            border-radius: 8px;
            color: #fff;
            font-size: 22px;
            text-decoration: none;
          "
          href="#"
          onClick="window.this_0xd1011e&&window.this_0xd1011e.StartGame();"
          >Play</a
        >
      </div>
    </center>

    <script>
      var loadScript = function (list, callback) {
        var loaded = 0;
        var loadNext = function () {
          loadSingleScript(list[loaded], function () {
            loaded++;
            if (loaded >= list.length) callback();
            else loadNext();
          });
        };
        loadNext();
      };

      var loadSingleScript = function (src, callback) {
        var s = document.createElement("script");
        s.async = false;
        s.src = src;
        s.onload = function () {
          s.parentNode.removeChild(s);
          callback();
        };
        document.body.appendChild(s);
      };

      var xhr = new XMLHttpRequest();
      xhr.open("GET", "./manifest.json?v=" + Math.random(), true);
      xhr.onload = function () {
        var manifest = JSON.parse(xhr.response);
        var list = manifest.initial.concat(manifest.game);
        loadScript(list, function () {
          egret.runEgret({
            renderMode: "webgl",
            audioType: 0,
            calculateCanvasScaleFactor: function (context) {
              return (
                (window.devicePixelRatio || 1) /
                (context.backingStorePixelRatio || 1)
              );
            },
          });
        });
      };
      xhr.send(null);
    </script>
  </body>
</html>
