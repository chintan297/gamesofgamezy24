<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta name="authoring-tool" content="Adobe_Animate_CC" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />
    <title>Adam N Eve: Adam the Ghost</title>

    <!-- Core libraries -->
    <script src="createjs-2015.11.26.min.js"></script>
    <link rel="stylesheet" href="font/fonts.css" />

    <!-- Game script -->
    <script src="aae_ghost.js"></script>

    <script>
      var mobiledevice;
      function detectmob() {
        if (
          /Android|webOS|iPhone|iPad|iPod|BlackBerry|Windows Phone/i.test(
            navigator.userAgent
          )
        ) {
          mobiledevice = 1;
        } else {
          mobiledevice = 0;
        }
      }
      detectmob();

      var canvas,
        stage,
        exportRoot,
        anim_container,
        dom_overlay_container,
        fnStartAnimation;
      var hlasitost = 1;
      createjs.Sound.setMute(false);

      var loadingBg = new createjs.Bitmap("images/loading/Bitmap2.png");
      var loadingBarBg = new createjs.Bitmap("images/loading/Bitmap22.png");
      var loadingBarFg = new createjs.Bitmap("images/loading/Bitmap59.png");
      var loadingAdam = new createjs.Bitmap("images/loading/Bitmap60.png");
      var rotateBg = new createjs.Bitmap("images/loading/rotate.jpg");
      var rotateBg2 = new createjs.Bitmap("images/loading/rotate2.jpg");
      var progressBar = new createjs.Shape();

      rotateBg.scaleX = 1280 / 1024;
      rotateBg2.scaleX = rotateBg2.scaleY = 2;

      loadingBg.x = -24;
      loadingBg.y = -6;
      loadingBarBg.x = 530;
      loadingBarBg.y = 641;
      loadingBarFg.x = 533;
      loadingBarFg.y = 647;
      loadingAdam.x = 550;
      loadingAdam.y = 409;

      loadingBarFg.mask = progressBar;
      createjs.Sound.alternateExtensions = ["ogg"];

      function init() {
        canvas = document.getElementById("canvas");
        stage = new createjs.Stage(canvas);
        stage.addChild(loadingBg, loadingBarBg, loadingBarFg, loadingAdam);

        anim_container = document.getElementById("animation_container");
        dom_overlay_container = document.getElementById(
          "dom_overlay_container"
        );

        var comp = AdobeAn.getComposition("AC8FCDAB37C70742A004FE8FF5DB462D");
        var lib = comp.getLibrary();
        createjs.MotionGuidePlugin.install();

        var loader = new createjs.LoadQueue(true);
        loader.installPlugin(createjs.Sound);
        loader.addEventListener("fileload", function (evt) {
          handleFileLoad(evt, comp);
        });
        loader.addEventListener("progress", handleProgress);
        loader.addEventListener("complete", function (evt) {
          handleComplete(evt, comp);
        });
        loader.loadManifest(lib.properties.manifest);

        resize();
      }

      function handleFileLoad(evt, comp) {
        var images = comp.getImages();
        if (evt && evt.item.type == "image") images[evt.item.id] = evt.result;
        resize();
      }

      function handleProgress(event) {
        progressBar.graphics
          .beginFill("#FFFF99")
          .drawRect(533, 647, 221 * event.progress, 14);
        stage.update();
      }

      function handleComplete(evt, comp) {
        var lib = comp.getLibrary();
        var ss = comp.getSpriteSheet();
        var queue = evt.target;
        var ssMetadata = lib.ssMetadata;

        for (i = 0; i < ssMetadata.length; i++) {
          ss[ssMetadata[i].name] = new createjs.SpriteSheet({
            images: [queue.getResult(ssMetadata[i].name)],
            frames: ssMetadata[i].frames,
          });
        }

        exportRoot = new lib.aae_ghost();
        stage = new lib.Stage(canvas);
        stage.enableMouseOver();
        fnStartAnimation = function () {
          stage.addChild(exportRoot);
          createjs.Ticker.setFPS(lib.properties.fps);
          createjs.Ticker.addEventListener("tick", stage);
        };
        AdobeAn.compositionLoaded(lib.properties.id);
        createjs.Touch.enable(stage);
        fnStartAnimation();
        resize();

        window.addEventListener("resize", doubleResize);
      }

      function playSound(id, loop) {
        return createjs.Sound.play(
          id,
          createjs.Sound.INTERRUPT_EARLY,
          0,
          0,
          loop
        );
      }

      function resize() {
        if (
          (window.innerHeight < window.innerWidth &&
            navigator.userAgent.match("Mac OS")) ||
          (screen.width == 720 &&
            screen.height == 1280 &&
            window.innerHeight < window.innerWidth &&
            navigator.userAgent.match("Android")) ||
          (screen.width != 720 &&
            screen.height != 1280 &&
            screen.height < screen.width &&
            navigator.userAgent.match("Android")) ||
          (window.innerHeight < window.innerWidth &&
            navigator.userAgent.match(/BlackBerry/i)) ||
          (window.innerHeight < window.innerWidth &&
            navigator.userAgent.match(/Windows Phone/i)) ||
          !mobiledevice
        ) {
          window.scrollTo(0, 0);
          stage.removeChild(rotateBg);
          stage.removeChild(rotateBg2);
          var GAME_WIDTH = 1280;
          var GAME_HEIGHT = 1024;
          var width = window.innerWidth || document.body.clientWidth;
          var ratio = document.body.clientWidth / 1280;

          var top_style = 50;
          if (
            /iPhone|iPad|iPod/i.test(navigator.userAgent) &&
            width / window.innerHeight > 2.1
          )
            top_style = 47;

          canvas.style.height =
            dom_overlay_container.style.height =
            anim_container.style.height =
              GAME_HEIGHT * ratio + "px";
          canvas.style.width =
            dom_overlay_container.style.width =
            anim_container.style.width =
              GAME_WIDTH * ratio + "px";
          [canvas, dom_overlay_container, anim_container].forEach((el) => {
            el.style.position = "absolute";
            el.style.left = "50%";
            el.style.top = top_style + "%";
            el.style.transform = "translate3d(-50%, -50%, 0)";
          });
        } else {
          window.scrollTo(0, 0);
          stage.addChild(rotateBg);
          stage.addChild(rotateBg2);
          var GAME_WIDTH = 1280;
          var GAME_HEIGHT = 1024;
          var ratio = document.body.clientWidth / 1280;

          canvas.style.height =
            dom_overlay_container.style.height =
            anim_container.style.height =
              GAME_HEIGHT * ratio + "px";
          canvas.style.width =
            dom_overlay_container.style.width =
            anim_container.style.width =
              GAME_WIDTH * ratio + "px";
          [canvas, dom_overlay_container, anim_container].forEach((el) => {
            el.style.position = "absolute";
            el.style.left = "50%";
            el.style.top = "50%";
            el.style.transform = "translate3d(-50%, -50%, 0)";
          });
          rotateBg2.x = 1280 / 2 - rotateBg2.getBounds().width;
          rotateBg2.y = 1024 / 2 - rotateBg2.getBounds().height;
        }
      }

      function doubleResize() {
        resize();
        setTimeout(resize, 500);
      }
    </script>
  </head>
  <body onload="init();" style="margin: 0" onresize="doubleResize();">
    <div
      id="animation_container"
      style="background-color: rgba(0, 0, 0, 1); width: 1280px; height: 1024px"
    >
      <canvas
        id="canvas"
        width="1280"
        height="1024"
        style="
          position: absolute;
          display: block;
          background-color: rgba(0, 0, 0, 1);
        "
      ></canvas>
      <div
        id="dom_overlay_container"
        style="
          pointer-events: none;
          overflow: hidden;
          width: 1280px;
          height: 1024px;
          position: absolute;
          left: 0px;
          top: 0px;
          display: block;
        "
      ></div>
    </div>
  </body>
</html>
